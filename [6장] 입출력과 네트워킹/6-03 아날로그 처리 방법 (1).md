# 아날로그 처리 방법

컴퓨터는 연속적인 대상을 저장하기 위해 데이터의 `샘플(sample)`을 취한다. 즉 시간이나 공간상 일정한 간격으로 값을 읽어야 한다. 저장한 데이터를 다시 영상이나 빛으로 보여주려면 샘플링 데이터를 `아날로그 신호`로 변환해야 한다.

<br />

## 디지털을 아날로그로 변환

**DA 변환기**(digital-to-analog converter, D/A, DAC 디지털을 아날로그로 바꾸는 변환기)
DA 변환기로 전압을 만들어낸다.
![6-22 LED를 사용해 만든 더 나은 DA 변환기](https://cdn.discordapp.com/attachments/879215554379018243/990298835857317908/unknown.png)
8비트를 이용해 256 수준의 전압을 만들어낼 수 있다.

해상도: DAC가 만들어낼 수 있는 최대 전압을 단계 수로 나눈 값

- ex) 오디오, 음악 신디사이저
- DAC 입력을 일정한 비율로 변경하면 파형을 만들 수 있다.

![톱니파 합성하기](https://cdn.discordapp.com/attachments/879215554379018243/990296465047957544/IMG_9722.jpg)

- 더 복잡한 파형을 만들려면 데이터를 써넣기 위한 **메모리**가 들어있다.
  메모리에 있는 데이터를 읽고, CPU가 수행하는 다른 작업과 무관하게 데이터를 일정한 비율로 읽어서 처리한다. 이 과정에서 `FIFO` 설정을 만들어 구현한다.

![높은 워터마크와 낮은 워터마크가 있는 FIFO](https://media.discordapp.net/attachments/879215554379018243/990296461797388318/IMG_9722.jpg?width=781&height=226)

FIFO 메모리에는 두 가지 트리거가 있다.

- **높은 워터마크(high-water mark)**
  - FIFO가 거의 꽉 찼을 때 인터럽트 발생
- **낮은 워터마크(low-water-mark)**
  - FIFO가 거의 빈 상태일 때 인터럽트를 발생

FIFO는 각기 다른 속도로 동작하는 여러 요소를 결합할 때 유용하다.

<br />

## 아날로그를 디지털로 변환

**AD 변환기**(analog-to-digital converter, A/D, ADC)
값을 측정할 수 있도록 아날로그 신호의 현재 값을 흔들리지 않게 안정적으로 잡아내야 한다. => **샘플**을 얻는다.

디지털화한 파형이 아날로그 파형과 닮기 위해서는 여러 번 샘플을 얻어야 한다. **샘플 앤드 홀드**(sample and hold) 회로를 사용해 아날로그 파형 값을 잡아낸다.

![샘플 앤드 홀드](https://cdn.discordapp.com/attachments/879215554379018243/990296920595521556/unknown.png)

스위치를 닫아서 샘플을 얻으면 아날로그 신호의 현재 값이 `저장 탱크`에 저장된다. `저장 탱크`에 안정적인 값이 들어있어 이를 측정해 디지털 값을 만들어낸다.
<br />

**비교기**
어떤 문턱값과 신호를 비교하는 장치로 `비교기(comparator)`을 사용한다. `비교기`는 문턱값을 선택하는 논리게이트와 비슷하다.

![아날로그 비교기](https://cdn.discordapp.com/attachments/879215554379018243/990299600046940242/unknown.png)

비교기의 `+` 입력 신호가 `-` 보다 크거나 같다면 출력 = 1, 그렇지 않으면 0이다.

<br />

**플래시 변환기**
비교기를 여러 `기준 전압`과 연결해 쌓으면 `플래시 변환기`를 만들 수 있다.

![플래시 변환기](https://media.discordapp.net/attachments/879215554379018243/990296461893853214/IMG_9724.jpg?width=496&height=495)

비트를 효율적으로 사용하지 못하고, 비교기를 많이 사용해야 해서 비싸다.
기준 전압을 변화시킬 수 있으면 비교기를 하나만 사용해도 되므로, `DAC`를 이용해서 기준 전압을 얻는다.

**AD 변환기(램프 변환기)**
![AD 변환기](https://cdn.discordapp.com/attachments/879215554379018243/990297255263240242/unknown.png)
`저장 탱크의 샘플값`과 `DAC`값을 비교하기 위해 비교기를 사용한다. Clear가 활성화되면 샘플값이 DAC 값과 같아질 때까지 카운터가 수를 센다. 값이 같아지면, 비교기의 출력이 0이 되면서 카운터가 비활성화되고, 원하는 값을 얻고 끝난다. 카운터에는 샘플을 디지털로 변환한 값이 들어있다.

DAC 출력이 경사로를 올라가는 것처럼 변하기 때문에 이런 ADC를 `램프 변환기`라고 부른다. 그러나 이 변환기는 변환이 오래 걸린다.

이를 개선하기 위해 **연속 추정 변환기**(successive approximation converter)가 있다. 하드웨어로 **2진 검색**(binary search)를 진행한다.
![](https://cdn.discordapp.com/attachments/879215554379018243/990296668396212314/unknown.png)

첫 클록에 DAC의 전체 범위의 절반으로 설정한다. 이 값이 샘플보다 작으면 1/4만큼 더 증가한다. 값이 샘플보다 크면 1/8 만큼 감소한다. 이런 식으로 샘플 값과 일치하는 값을 찾는다.
