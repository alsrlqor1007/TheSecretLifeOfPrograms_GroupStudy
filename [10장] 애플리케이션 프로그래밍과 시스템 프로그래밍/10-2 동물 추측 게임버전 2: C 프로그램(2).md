## 동물 추측 게임버전 2: C 프로그램(2)

### 추상화를 활용한 코드 개선

C 프로그램으로는 앞의 동물 추측 게임에서 마지막 게임 상태를 저장했다가 다시 불러와 게임을 수행할 수 있다. 이는 `파일 추상화`로 인한 부수적인 장점이라고 할 수 있다.
이런 기능을 자바스크립트로 구현하기는 쉬운 일이 아니다.

운영체제는 파일과 장치에 대해 똑같은 인터페이스를 제공한다. 브라우저나 C 프로그램 버전 모두에서 동일하게 사용된다.
이 말은, C 프로그램은 브라우저처럼 파일에서 입력을 받는 코드를 장치에서 입력을 받는 부분에 쓸 수 있다는 뜻이다.

하지만 브라우저는 자바스크립트를 통해 추상화를 개발자에게 넘기지 않고, 다른 인터페이스의 다른 코드를 사용해서 새 기능을 추가해야 한다.
이처럼 인터페이스의 선택은 프로그래밍의 편의와 결과의 명확성에 큰 영향을 끼친다.

<br></br>

### 런타임 라이브러리와 표준 입출력

C 프로그램을 실행하기 위해서는 코드를 컴파일한 다음, 컴파일이 된 코드와 해당 코드가 사용하는 stdio 라이브러리 등의 다른 코드를 링크(link)해야 한다.
이처럼 `런타임 라이브러리`도 포함해야 하는데, 런타임 라이브러리는 스택과 힙을 설정해서 사용할 수 있도록 준비하는 등의 설정을 담당하며, 터미널 장치 드라이버와 연관된 파일을 입력과 출력을 위해 연다.

`stdio` 라이브러리는 시스템 파일 디스크립터를 파일 포인터(file pointer)와 연관시킨다. `파일 디스크립터`는 프로세스에서 특정 파일에 접근할 때 사용하는 추상적인 값이며, `파일 포인터`는 버퍼링이나 파일 관리에 필요한 데이터 구조를 가리킨다.
stdio는 `stdin(표준 입력)`, `stdout(표준 출력)`, `stderr(표준 오류 출력)` 3가지 파일 포인터를 제공한다.
프로그램이 프로세스로 메모리에서 실행될 때, 표준 입력(Standard Input), 표준 출력(Standard Output), 표준 에러(Standard Error)에 각각 `0, 1, 2`라는 정수가 할당된다.

그리고 stdout과 stderr는 똑같은 대상으로 데이터를 내보내지만, stderr는 버퍼를 사용하지 않고 stdout은 버퍼를 사용한다. 버퍼로 보낸다면 프로그램이 중단될 때까지 표시되지 않을 수 있다.

<br></br>

### 버퍼 오버플로(Buffer overflow)

버퍼 오버런(buffer overrun)이라고도 하며, 메모리를 다루는 데에 오류가 발생해 잘못된 동작을 일으키는 프로그램의 취약점이다.
단어 그대로 버퍼가 흘러넘쳐 발생하는 것으로 데이터를 메모리에 저장할 때 개발자가 지정한 메모리의 바깥 쪽에 저장하는 것이다.
즉, 선언된 크기보다 더 큰 데이터를 기록해 발생하는 현상이다.
이렇게 벗어난 데이터는 가까운 메모리를 덮어쓰게 되는데, 해당 메모리에 다른 데이터가 저장되어 있을 수 있다.
이로 인해 메모리 접근 오류, 프로그램 종료 또는 시스템 정보 노출 등이 발생할 수 있다.

이는 보통 데이터를 저장하는 과정에서 저장될 메모리 위치가 유효한지 검사하지 않아서 발생한다고 한다.
데이터의 크기를 확인하지 않고 데이터를 저장하는 함수를 사용하는 경우, 버퍼의 크기를 초과하여 데이터를 저장한다.
데이터를 저장할 때, 스택 베이스 주소를 가리키는 레지스터를 넘어서는 메모리 공간까지 침범하게 되고, 만일 해당 메모리에 해커가 악의적으로 다른 메모리 공간의 주소와 같은 악성코드를 넣으면 스택 오버플로우가 발생한다.

<br></br>

### 참고 자료
- [파일 디스크립터(File Descriptor) 란 무엇인가?](https://twofootdog.tistory.com/51)
- [버퍼 오버플로우(Buffer Overflow)](https://byounghee.tistory.com/20)